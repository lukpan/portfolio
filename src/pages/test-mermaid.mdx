---
layout: ../layouts/Layout.astro
title: Mermaid Diagram Test
description: Testing Mermaid diagram rendering
---

import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import MermaidDiagram from '../components/MermaidDiagram.astro';

<Header />

<div class="max-w-6xl mx-auto px-6 py-20">
  <h1 class="text-4xl font-bold text-gray-900 mb-8">Mermaid Diagram Test</h1>
  
  <div class="bg-white rounded-lg shadow-lg p-8">
    <h2 class="text-2xl font-semibold mb-4">Marcus Aurelius AI System Architecture</h2>
    
    <MermaidDiagram diagram={`graph LR
    %% Define Nodes
    subgraph Client Endpoint
        Browser(["ğŸ“±/ğŸ’» User Browser\n(Client UI & Daily JS SDK)"])
    end

    subgraph "External Cloud Services (SaaS)"
        Daily{{"ğŸŒ Daily.co\n(WebRTC Transport Hub)"}}
        OpenAI[["ğŸ§  OpenAI Realtime API\n(Speech-to-Speech Intelligence)"]]
        HeyGen[["ğŸ¬ HeyGen API\n(Avatar Video Generation)"]]
    end

    subgraph "Application Platform (Fly.io Deployment)"
        FastAPI["âš™ï¸ FastAPI Server\n(Auth, API, Orchestration)"]
        Bot[("ğŸ¤– Bot Process (Pipecat)\n(One per session)")]
    end

    %% Control Flow (HTTP)
    Browser -- "1. Auth & Start Session (HTTP)" --> FastAPI
    FastAPI -- "2. Spawns isolated process" --> Bot

    %% Real-time Media Flow (WebRTC)
    Browser <===>|"3. Encrypted Media Stream\n(Mic Input / A/V Output)"| Daily
    Bot <===>|"3. Encrypted Media Stream\n(A/V Input / A/V Output)"| Daily

    %% AI Processing Loop
    Bot -- "4. User Audio Input" --> OpenAI
    OpenAI -- "5. Marcus Voice Audio" --> Bot
    Bot -- "6. Sync Video Request" --> HeyGen
    HeyGen -- "7. Avatar Video Frames" --> Bot

    %% Styling for visual appeal
    classDef client fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#01579b;
    classDef platform fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px,color:#2e7d32;
    classDef services fill:#fff3e0,stroke:#ef6c00,stroke-width:2px,color:#ef6c00;
    classDef transport fill:#f3e5f5,stroke:#7b1fa2,stroke-width:4px,color:#7b1fa2;
    classDef botProcess fill:#c8e6c9,stroke:#2e7d32,stroke-width:3px,color:#2e7d32;

    class Browser client;
    class FastAPI,Bot platform;
    class OpenAI,HeyGen services;
    class Daily transport;
    class Bot botProcess;

    %% Link Styling
    linkStyle 0,1 stroke:#2e7d32,stroke-width:2px,fill:none;
    linkStyle 2,3 stroke:#7b1fa2,stroke-width:4px,fill:none;
    linkStyle 4,5,6,7 stroke:#ef6c00,stroke-width:2px,fill:none,stroke-dasharray: 5 5;`} />
  </div>
  
  <div class="bg-white rounded-lg shadow-lg p-8 mt-8">
    <h2 class="text-2xl font-semibold mb-4">AI Content Generation Workflow</h2>
    
    <MermaidDiagram diagram={`graph TD
    subgraph Inputs["ğŸ“¥ INPUTS"]
        SME["ğŸ“š SME Knowledge"]
        PERSONA["ğŸ‘¤ Alex Chen Persona"]
        IDP["ğŸ“‹ Instructional Design Plan"]
    end

    subgraph Core["âš™ï¸ CORE WORKFLOW"]
        PLAN["ğŸ¯ Planning<br/>Generate Outline"]
        RESEARCH["ğŸ” Research<br/>Deep Dive & Examples"]
        DRAFT["âœï¸ Draft Creation<br/>Content + Code"]
        CRITIQUE["ğŸ“ Quality Review<br/>Score Against Rubric"]
        REFINE["âœ¨ Refinement<br/>Polish & Improve"]
    end

    subgraph Finalize["ğŸš€ FINALIZATION"]
        QUIZ["â“ Create Quizzes"]
        STYLE["ğŸ“ Style & Format"]
        MOODLE["ğŸ“¦ Moodle XML"]
        INTEGRATE["ğŸ”— Catalogue Integration"]
    end

    subgraph Output["ğŸ“¤ OUTPUT"]
        FINAL["âœ… Published Learning Module"]
    end

    %% Main flow
    Inputs --> PLAN
    PLAN --> RESEARCH
    RESEARCH --> DRAFT
    DRAFT --> CRITIQUE
    CRITIQUE --> REFINE
    REFINE --> QUIZ
    REFINE --> STYLE
    QUIZ --> MOODLE
    STYLE --> INTEGRATE
    MOODLE --> FINAL
    INTEGRATE --> FINAL

    %% Dark theme styling matching Marcus Aurelius
    classDef inputStyle fill:#2d1b0e,stroke:#f59e0b,stroke-width:3px,color:#f9fafb,font-weight:bold;
    classDef coreStyle fill:#1a2234,stroke:#fbbf24,stroke-width:3px,color:#f9fafb,font-weight:bold;
    classDef finalizeStyle fill:#1e1b4b,stroke:#a78bfa,stroke-width:3px,color:#f9fafb,font-weight:bold;
    classDef outputStyle fill:#0f1419,stroke:#fb923c,stroke-width:4px,color:#f9fafb,font-weight:bold;

    class SME,PERSONA,IDP inputStyle
    class PLAN,RESEARCH,DRAFT,CRITIQUE,REFINE coreStyle
    class QUIZ,STYLE,MOODLE,INTEGRATE finalizeStyle
    class FINAL outputStyle
    
    %% Link styling
    linkStyle 0,1,2,3,4 stroke:#fbbf24,stroke-width:3px;
    linkStyle 5,6,7,8 stroke:#a78bfa,stroke-width:3px;
    linkStyle 9,10 stroke:#fb923c,stroke-width:3px;`} />
  </div>
  
  <div class="bg-white rounded-lg shadow-lg p-8 mt-8">
    <h2 class="text-2xl font-semibold mb-4">Paper Grader - High-Level Architecture</h2>
    
    <MermaidDiagram diagram={`flowchart TD
    subgraph INPUT["ğŸ“¥ INPUT"]
        PAPERS["ğŸ“„ Student Papers<br/>PDF & DOCX"]
        CONFIG["âš™ï¸ Configuration<br/>Rubric & Moderation"]
    end
    
    subgraph PROCESS["âš™ï¸ PROCESSING"]
        CONVERT["ğŸ“‘ Convert<br/>Extract Text & Tables"]
        ANON["ğŸ”’ Anonymize<br/>Remove Identifiers"]
        GRADE["ğŸ¤– Grade with AI<br/>Claude Sonnet 4.5"]
        SAVE["ğŸ’¾ Save Results<br/>Feedback & Logs"]
    end
    
    subgraph OUTPUT["ğŸ“¤ OUTPUT"]
        FEEDBACK["ğŸ“ Graded Papers<br/>Detailed Feedback"]
        MAPPING["ğŸ” Student Mapping<br/>Secure Identity Map"]
    end
    
    subgraph REIDENT["ğŸ”„ RE-IDENTIFICATION"]
        TOOLS["ğŸ› ï¸ Lookup Tools<br/>Export Grades"]
    end
    
    %% Main flow
    INPUT --> CONVERT
    CONVERT --> ANON
    ANON --> GRADE
    GRADE --> SAVE
    SAVE --> FEEDBACK
    SAVE --> MAPPING
    FEEDBACK --> TOOLS
    MAPPING --> TOOLS
    
    %% Dark theme styling
    classDef inputStyle fill:#2d1b0e,stroke:#f59e0b,stroke-width:3px,color:#f9fafb,font-weight:bold;
    classDef processStyle fill:#1a2234,stroke:#fbbf24,stroke-width:3px,color:#f9fafb,font-weight:bold;
    classDef outputStyle fill:#1e1b4b,stroke:#a78bfa,stroke-width:3px,color:#f9fafb,font-weight:bold;
    classDef reidentStyle fill:#0f1419,stroke:#fb923c,stroke-width:3px,color:#f9fafb,font-weight:bold;
    
    class PAPERS,CONFIG inputStyle
    class CONVERT,ANON,GRADE,SAVE processStyle
    class FEEDBACK,MAPPING outputStyle
    class TOOLS reidentStyle
    
    %% Link styling
    linkStyle 0,1,2,3 stroke:#fbbf24,stroke-width:3px;
    linkStyle 4,5 stroke:#a78bfa,stroke-width:3px;
    linkStyle 6,7 stroke:#fb923c,stroke-width:3px;`} />
  </div>
  
  <div class="bg-white rounded-lg shadow-lg p-8 mt-8">
    <h2 class="text-2xl font-semibold mb-4">Paper Grader - Data Flow</h2>
    
    <MermaidDiagram diagram={`flowchart TD
    START(["ğŸš€ Start Batch Grading"])
    
    SETUP["ğŸ“‹ Load Config<br/>Rubric & Settings"]
    
    SCAN["ğŸ” Scan Papers<br/>PDF & DOCX Files"]
    
    LOOP{"ğŸ“„ For Each Paper"}
    
    CONVERT["ğŸ“‘ Convert<br/>Extract Text"]
    
    ANONYMIZE["ğŸ”’ Anonymize<br/>Remove Identifiers"]
    
    GRADE["ğŸ¤– Grade with AI<br/>Send to Claude"]
    
    SAVE["ğŸ’¾ Save Results<br/>Feedback & Logs"]
    
    CHECK{"More Papers?"}
    
    COMPLETE(["âœ… Batch Complete"])
    
    START --> SETUP
    SETUP --> SCAN
    SCAN --> LOOP
    LOOP --> CONVERT
    CONVERT --> ANONYMIZE
    ANONYMIZE --> GRADE
    GRADE --> SAVE
    SAVE --> CHECK
    
    CHECK -->|Yes| LOOP
    CHECK -->|No| COMPLETE
    
    %% Dark theme styling
    classDef startEnd fill:#2d1b0e,stroke:#f59e0b,stroke-width:4px,color:#f9fafb,font-weight:bold;
    classDef process fill:#1a2234,stroke:#fbbf24,stroke-width:3px,color:#f9fafb,font-weight:bold;
    classDef decision fill:#1e1b4b,stroke:#a78bfa,stroke-width:3px,color:#f9fafb,font-weight:bold;
    classDef secure fill:#0f1419,stroke:#fb923c,stroke-width:3px,color:#f9fafb,font-weight:bold;
    
    class START,COMPLETE startEnd
    class SETUP,SCAN,CONVERT,GRADE,SAVE process
    class LOOP,CHECK decision
    class ANONYMIZE secure
    
    %% Link styling
    linkStyle 0,1,2 stroke:#fbbf24,stroke-width:3px;
    linkStyle 3,4,5,6,7 stroke:#fbbf24,stroke-width:3px;
    linkStyle 8 stroke:#a78bfa,stroke-width:3px;
    linkStyle 9 stroke:#fb923c,stroke-width:3px;`} />
  </div>
</div>

<Footer />
